\chapter{The Large Hadron Collider and the CMS Detector}

The searches for new physics discussed in the next chapter analyze data recorded by the Compact Muon Solenoid (CMS) experiment.
The CMS detector itself straddles beams generated by the Large Hadron Collider (LHC), a particle collider located at CERN in Geneva, Switzerland.
CMS directly measures the products of collisions between the protons in these beams, digitizes the measurements, and records a small subset of these events.
The data is then processed by reconstruction algorithms and shared across the worldwide CMS computing grid.
This chapter describes the LHC and CMS.

\section{The Large Hadron Collider} \label{sec:LHC}

A detailed description of the LHC is available in Reference~\cite{LHC_TDR}.
This section provides a summary of the essential information.

  \subsection{A Brief Description} \label{sec:LHCdescription}

  Although it sometimes collides atomic nuclei, typically Pb-208, the LHC is primarily a proton-proton collider, and that is the operational mode we shall consider in this work.
  The LHC is the highest energy and highest luminosity proton-proton collider ever constructed, thus far achieving collisions with center of momentum frame energy as large as 13\~TeV, produced by two counterrotating beams of 6.5\~TeV protons, at sustained rates on the order of one billion collisions per second.

  Producing such high energy collisions at such high intensity requires that the LHC be a large ring, 27~km in circumference.
  The circular shape allows multiple opportunities for the protons in each beam to collide, rather than a single all-or-nothing pass, and additionally allows the beams to be circulated for as long as necessary to accelerate them up to the intended energy, at a rate of 0.5~MeV per revolution.
  The size makes it possible for the protons to be constrained to travel in a circle, even at very high energies.
  The beams are constrained to travel in the ring using powerful magnetic fields, and the maximum feasible magnetic field strength is the primary limit on the maximum achievable beam energy.
  The LHC beams require an 8.36~T field to stay on track, provided by superconducting niobium-titanium electromagnets carrying a current of 11,080\~A.
  Superconductors stable at greater magnetic field strengths are rare and expensive, and the magnets must be superconducting to carry such enormous currents.
  Larger rings reduce the beams' curvature and allow for greater energies with the same magnetic field strength.

  Protons are chosen for the beams rather than electrons, the only other obvious potential choice, for two reasons.
  First, protons are composite particles, so their total energies are distributed among their many subcomponents, referred to as partons in this context.
  Collisions between protons with energy 6.5~TeV each are in fact collisions between a parton in each proton with some fraction of the total energy.
  This naturally scans across the accessible energy range, providing sensivity to any new state with mass on the TeV scale.
  Were the beams composed of elementary particles like electrons, the collider would need to scan the beam energy to provide sensitivity to any possible mass.
  Therefore, electron colliders are poorly suited for new discoveries compared to proton colliders, and better suited for studying a state with known mass in greater detail.
  Second, and more importantly, the mass of the proton is much greater than that of the electron, reducing energy losses to synchrotron radiation.
  Because synchrotron losses are relatively small, circular colliders of protons are limited chiefly by the magnetic field strength, as discussed above.
  Electron colliders, on the other hand, are limited by synchrotron losses.
  Illustrating this, the Large Electron Positron (LEP) collider previously occupied the same tunnel that now houses the LHC, and managed a maximum collision energy of only 209~GeV~\ref{lep_chargino}.

  The protons are not collided one-by-one, as this would be impossibly tedious.
  Instead, they are grouped in bunches of over 100 billion, spaced by 25~ns to make it possible for the detectors to distinguish the products of one bunch crossing from those of the preceding and following crossings.
  During each bunch crossing, a few dozen proton pairs (see Figure~\ref{fig:pileup}) collide simultaneously, of which either one or none are interesting and the rest are undesirable noise called pileup, discussed in Section~\ref{sec:pileup}.
  These bunch crossings occur at a few points around the LHC tunnel occupied by detectors.
  Among them are the CMS detector, described in Section~\ref{sec:CMS}, and its sister detector ATLAS, which are both general-purpose detectors designed to study any and all phenomena at the TeV scale, and operate in parallel to provide independent checks of any discoveries.

  \subsection{Luminosity Delivered} \label{sec:lumi}

    \begin{figure}[h!]
    \centering
    \includegraphics[width=0.65\textwidth]{figures/efficiencyVsPt.pdf}
    \caption[CMS integrated luminosity delivered and recorded over time.]{
      The integrated luminosity delivered to CMS over time by the LHC, in blue, and the portion CMS managed to record, in yellow.
      As can be seen, CMS is not 100% efficient at recording collisions. 
      It is important to note that this inefficiency is a straightforward failure to observe the events, {\it not} the purposeful rejection of events by the trigger system discussed in Section~\ref{sec:trigger}.
      Taken from \cite{lumipublic}.}
    \label{fig:intlumi}
  \end{figure}  


  The sensitivity of searches performed in CMS scales straightforwardly with the total number of collisions provided by the LHC.
  Thus far, the LHC has provided CMS with nearly 200~\fbinv across all operating periods, with the rate accelerating as the machine is pushed to the limits of its design, as shown in Figure~\ref{fig:intlumi}.
  The searches discussed in the next chapter use only the 137~\fbinv recorded by CMS during the 13~TeV runs from 2016 to 2018.
  As the total inelastic proton-proton collision cross section is approximately 69.2~mb at 13~TeV, the total number of collisions observed by CMS from 2016 to 2018 is nearly $10^{16}$.
  While this vast sample size makes very rare genuine physics processes potentially observable, it also presents a challenge in that very rare and difficult to model detector failures may pollute the dataset.
  It is prudent to adopt a conservative approach to any searches for rare new physics.

\section{The CMS Detector} \label{sec:CMS}

  While the LHC provides the collisions, it is the Compact Muon Solenoid (CMS) detector that ultimately measures the products and reconstructs each event.
  A detailed description of all of the CMS hardware and software is available in Reference~\cite{cms_tdr}, and a description of the general event reconstruction technique used at CMS, called Particle Flow, is available in Reference~\cite{particleflow}.
  This section serves as a general overview of how CMS works, sufficient to understand the searches for new physics presented later in this work.

  The particles stable enough to be detected directly by CMS come in 5 distinct varieties, namely electrons, muons, photons, charged hadrons (largely protons, pions, and charged kaons), and neutral hadrons (largely neutrons and neutral kaons).
  Figure~\ref{fig:cmsreconstruction} depicts a generic detection of each kind of particle.
  All other particles are too unstable to be measured directly, except the neutrinos.
  Neutrinos are, uniquely among Standard Model particles, both stable and invisible to CMS.
  Their presence in the products of a collision is inferred by measuring all of the visible content of an event, and noting that some energy is missing, as discussed in Section~\ref{sec:MET}.
  Any stable weakly interacting particles beyond the Standard Model produced in a collision at CMS would present a similar signature.

  \begin{figure}[h!]
    \centering
    \includegraphics[width=0.85\textwidth]{figures/cmsreconstruction.pdf}
    \caption[Image depicting the experimental signatures of different types of particle at CMS.]{
      The design of CMS causes particles of different types to leave distinct experimental signatures, allowing them to be distinguished.
      The rest of this section references and explains this image.
      Taken from \cite{particleflow}.}
    \label{fig:cmsreconstruction}
  \end{figure}  

  The CMS detector is a cylinder composed of a central barrel section with two flat endcaps, each of which contain layers of different detection systems designed to provide the information necessary to distinguish the various particles that can be generated by collisions, and measure their positions and energies.
  Starting from the beam pipe, they are the tracker, the electromagnetic calorimeter, the hadronic calorimeter, and the muon system.
  The tracker and the calorimeters are inside a solenoid producing a magnetic field, while the muon system is subject only to the external, returning field of the solenoid.
  Altogether, the detector measures about 7.5 meters in radius and 21 meters in length.
  As suggested by the cylindrical detector shape, the experiment uses a cylindrical coordinate system, in which the beam axis is assigned to the z axis, and the angle in the transverse plane, $\phi$, is measured starting from a line connecting CMS to the center of the LHC ring.

  This section describes each of the subsystems, as well as the objects that are constructed using their measurements.

  \subsection{Magnet} \label{sec:magnet}

  As its name suggests, a major feature of the CMS detector is a superconducting solenoid, the largest ever built, which provides a constant 3.8~T magnetic field in the tracker and calorimeters.
  This magnetic field curves the trajectories of charged particles, allowing for a determination of their charges and assisting in the measurement of their masses and energies, contributing to highly accurate identification of particles.
  
  CMS is compact in part to make it possible to fit the bulk of the detector inside this single solenoid.
  This maximizes the strength and consistency of the magnetic field, which in turn maximizes the precision with which particle positions, and the curvatures of their trajectories, can be measured.

  In Figure~\ref{fig:cmsreconstruction}, one can see the path of an electron (orange) curving sharply, in a direction indicating that it is negatively charged.
  Similarly, the path of a charged hadron (solid green) curves in the opposite direction, indicating a positive charge.
  A positively charged muon (blue) curves first one way, then the reverse once the field flips after exiting the solenoid.
  Neutral particles (dotted lines) do not curve at all.

  \subsection{Tracker} \label{sec:tracker}

  The silicon tracker is the innermost detector system and is primarily responsible for measuring the positions of charged particles.  
  In Figure~\ref{fig:cmsreconstruction}, the trajectories of neutral particles are represented with dotted lines, to indicate that they do not actually leave those tracks in the detector.
  The tracker is critically important for the disappearing tracks search covered in Section~\ref{sec:distracks}, and so is described here in more detail than the other detector systems.

  \begin{figure}[h!]
    \centering
    \includegraphics[width=0.75\textwidth]{figures/TrackerLayout.pdf}
    \caption[Layout of the tracker up to 2016.]{
      A slice of the CMS tracker in the $r-z$ plane, with the inner pixel tracker (red) in the 3-layer configuration used until 2016.
      In 2017 and 2018, the pixel tracker was upgraded with a 4th layer.
      The tracker is symmetric about the beam axis ($r=0$); one should imagine rotating this image around the horizontal axis to form a cylinder, to visualize the tracker's 3-dimensional form.
      The labels in green text denote tracker subsystems, the Tracker End Cap, the Tracker Inner Disk, the Pixel Tracker, the Tracker Inner Barrel, and Tracker Outer Barrel.
      The interior subsystems have more miniaturized detector elements and, therefore, better resolution.
      Taken from \cite{cmstracking}.}
    \label{fig:trackerlayout}
  \end{figure}  

  \begin{figure}[h!]
    \centering
    \includegraphics[width=0.65\textwidth]{figures/hitefficiency.pdf}
    \caption[Efficiency for a genuine particle to leave an expected hit in the CMS tracker.]{
      The efficiency for a genuine charged particle to produce an expected hit in the various components of the CMS pixel tracker, in the configuration used in 2016 and earlier. 
      Fake tracks may have many missing expected hits, but more than one or perhaps two is extremely rare in tracks produced by genuine particles.
      The probability for a neutral particle to produce a hit is small, and the probability to leave enough to produce a track is negligible.
      Taken from \cite{cmstracking}.}
    \label{fig:hitefficiency}
  \end{figure}  

  As shown in Figure~\ref{fig:trackerlayout}, the tracker is composed of several discrete layers.
  When a charged particle passes through a layer, it usually causes a measurable current to flow in the silicon, and is said to have produced a ``hit.''  
  As shown in Figure~\ref{fig:hitefficiency}, the probability for a genuine particle to leave a hit is near but not quite unity, so a missing hit where one would be expected is credible but cause for skepticism.
  Each event produces an intimidating array of these discrete hits throughout the tracker, which must then be connected by the track reconstruction algorithm into particle tracks.
  CMS uses an iterative procedure described in Reference~\cite{cmstracking}, in which clean, high energy, isolated tracks are reconstructed first so that their hits may be removed from the pool, followed by the next most obvious tracks, and so on, dramatically simplifying the computational complexity of each step.
  The early iterations that produce the tracks judged to be of highest quality find only those tracks with transverse momenta at least 0.3~GeV, and no iteration can produce a track with transverse momentum below 0.1~GeV, so that particles of such low energy are effectively invisible to CMS.
  Note that, due to the strong magnetic field present in the tracker, particles with energies lower than around 0.1 GeV travel in such tight spirals that reconstruction becomes infeasible.
  Although this is normally insignificant, since these particles are not typically important to an event's overall characterization, this fact allows for the existence of disappearing tracks, in which a high energy charged particle decays to a trackless neutral particle and a charged particle of such low energy that it is not reconstructed.
  Additionally, all tracks must be composed of at least 3 hits.

  The performance is outstanding, especially for tracks passing the sophisticated ``high purity'' selection applied by the vast majority of CMS analyses. 
  Figure~\ref{fig:trackfakerate} shows the fake rate of this procedure, less than 5\% for tracks in the intermediate energy range, and further suppressible with additional cleaning selections like those of the disappearing tracks search covered in Section~\ref{sec:distracks}.
  Figure~\ref{fig:trackefficiency} shows the efficiency to reconstruct tracks successfully for the three most common varieties of charged particles measured by CMS, namely muons (left), electrons (center), and pions (right), approaching unity in all cases for higher energy tracks in the barrel region of the tracker.

  \begin{figure}[h!]
    \centering
    \includegraphics[width=0.65\textwidth]{figures/fakerateVsPt.pdf}
    \caption[Track fake rate.]{
      The CMS track fake rate as a function of \pt, in the configuration used in 2016 and earlier. 
      The sophisticated high purity selection aims to suppress the fake rate without badly affecting efficiency and is applied in the vast majority of CMS analyses. 
      Taken from \cite{cmstracking}.}
    \label{fig:trackfakerate}
  \end{figure}  

  \begin{figure}[h!]
    \centering
    \includegraphics[width=0.3\textwidth]{figures/mu/efficiencyVsPt.pdf}
    \includegraphics[width=0.3\textwidth]{figures/el/efficiencyVsPt.pdf}
    \includegraphics[width=0.3\textwidth]{figures/pi/efficiencyVsPt.pdf}
    \caption[Track reconstruction efficiency.]{
      The CMS track reconstruction efficiency for (left) muons, (center) electrons, and (right) pions, split by detector region as a function of \pt, in the configuration used in 2016 and earlier. 
      Muons are by far the cleanest objects at CMS as they are massive enough to avoid strong perturbations by tracker material, and lack nuclear interactions.
      Electrons are lighter and so are vulnerable to tracker interactions, experiencing strong bremsstrahlung losses, while pions can undergo nuclear interactions.
      Taken from \cite{cmstracking}.}
    \label{fig:trackefficiency}
  \end{figure}  

  \begin{figure}[h!]
    \centering
    \includegraphics[width=0.4\textwidth]{figures/pi/resolutionD0VsEta.pdf}
    \includegraphics[width=0.4\textwidth]{figures/pi/resolutionDzVsEta.pdf}
    \caption[Impact parameter resolution in the CMS tracker.]{
      The CMS tracker has micron-level impact parameter resolution, for both (left) the transverse plane and (right) the z direction.
      Solid markers indicate the half-width of the 68\% confidence interval, while open markers indicate 90\% confidence.
      With this resolution, a track reconstructed with an impact parameter of more than a few hundred microns is likely a fake, from a pileup vertex, or from a secondary vertex produced by a decaying particle like a bottom hadron.
      Taken from \cite{cmstracking}.}
    \label{fig:trackresolution}
  \end{figure}  

  The tracker detection elements are smaller and consequently provide better localization in interior layers of the tracker, with the pixel detector components only approximately 100 $\mu$m across.
  As a general guideline, no element in the tracker is permitted to have an expected probability of a hit greater than 1\% per bunch crossing, to maintain a low probability of tracks intersecting.
  This structure produces outstanding sub-millimeter resolution of a track's origin, shown in Figure~\ref{fig:trackresolution}, allowing tracks originating from collisions only microns apart to be separated, and tracks originating from decays of particles with decay lengths on the order of a millimeter to be identified.
  The former is important for rejection of pileup, and the latter for identification of jets originating from bottom quark hadrons.

  \begin{figure}[h!]
    \centering
    \includegraphics[width=0.4\textwidth]{figures/MaterialBudget_RadLengths.pdf}
    \includegraphics[width=0.4\textwidth]{figures/MaterialBudget_InteractionLengths.pdf}
    \caption[Tracker material budget.]{
      The CMS tracker material budget in (left) radiation lengths (ie electromagnetic) and (right) interaction lengths (ie nuclear), in the configuration used in 2016 and earlier. 
      While the CMS tracker is not intended to shower particles, only to measure positions as gently as possible, some amount of interaction between tracker material and collision products is inevitable.
      Taken from \cite{cmstracking}.}
    \label{fig:trackerbudget}
  \end{figure}  

  \begin{figure}[h!]
    \centering
    \includegraphics[width=0.85\textwidth]{figures/PionSurvivalProbability.pdf}
    \caption[Pion survival in the tracker.]{
      The probability for pions to undergo nuclear interactions in the CMS tracker by layer, in the configuration used in 2016 and earlier. 
      In rare cases, the pion may shower in such a way that no charged daughters have high enough energy to be reconstructed, causing its track to disappear.
      Taken from \cite{cmstracking}.}
    \label{fig:pionsurvival}
  \end{figure}  

  As a general rule, the tracker intends to interact with particles only to the extent absolutely necessary to measure their positions.
  Strong interactions between the tracker and the particles it is measuring modify the particles' tracks and affect their energies, and are therefore undesirable.
  Unfortunately, electrons are so strongly affected by bremsstrahlung that the tracker is quite thick in terms of radiation lengths, as shown in Figure~\ref{fig:trackerbudget} (left).
  Therefore, electrons at CMS are experimentally observed more as clouds of bremsstrahlung photons by the time they reach the electromagnetic calorimeter at CMS, and must be reconstructed with a special tracking procedure, the Gaussian-sum filter described in \cite{gsftracking}.
  In terms of interaction lengths, the CMS tracker is much thinner, as shown in Figure~\ref{fig:trackerbudget} (right).
  The vast majority of hadrons therefore reach the calorimeters without having undergone a nuclear interaction.
  Figure~\ref{fig:pionsurvival} shows that over 80\% of high energy charged pions reach the calorimeters intact.
  Even so, 80\% is not 100\%.
  Pion tracks occasionally terminate in a shower induced by a collision with a nucleus inside the tracker.
  In rare cases, these showers can contain {\it zero} visible particles of any kind.
  These disappearing pions constitute an important background for the disappearing tracks search.

  \subsection{Electromagnetic Calorimeter} \label{sec:ecal}

  The primary purpose of the electromagnetic calorimeter (ECAL) is to observe the energies of photons, which do not leave tracks.
  It is also important in the observation of electrons, which produce a jet of photons due to bremsstrahlung in the tracker.
  Other electromagnetically interacting particles will also leave small ECAL deposits, but much less due to their lesser tendency to produce photons.
  In Figure~\ref{fig:cmsreconstruction}, the electron (red) and photon (dotted blue) produce strong showers in the ECAL (green), while the other particles leave negligible deposits.

  The design prioritizes good resolution of photon energies and positions over all else, due to the experimental importance of the Higgs boson's decay to a pair of isolated photons.
  To accomplish this, the ECAL is constructed from tens of thousands of scintillating lead tungstate crystals, which has several desirable properties.

  First, these crystals have a Moliere radius of only 2.2~cm \cite{cms_tdr}.
  Aside from providing generally good position resolution, this small Moliere radius most importantly allows a prompt isolated photon, perhaps from a Higgs decay, to be distinguished from two closely overlapping photons produced by the decay of a neutral pion, because the two separate showers produced by the photon pair are clearly separated in the ECAL cells.
  These two nearby showers may merge into a single large shower indistinguishable from that of a single photon in a material with a larger Moliere radius.
  Similarly, photons produced inside jets can be distinguished from truly isolated photons, since the showers of other particles in the jets can be discriminated from the photon's own shower.
  Although the size of the shower is restricted, a typical one will still extend over a few adjacent crystals as shown in Figure~\ref{fig:cmsreconstruction}, so that a 5-by-5 cluster of crystals, or potentially a smeared supercluster for electrons that have radiated over a larger area, is the essential object of ECAL reconstruction.
  Studying the distribution of energy measurements across the crystals in a cluster, as described in \cite{ecal_algorithm}, allows for better fake rejection and energy resolution of 1\% \cite{ecal_energy_resolution}.

  Second, lead tungstate also has an extremely short radiation length, only 0.89~cm compared to the roughly 2 radiation lengths of the entire 1~m radius tracker, so it contains electrons very efficiently \cite{cms_tdr}.

  Third, scintillation in lead tungstate happens quickly, with 80\% of the light produced within 25~ns \cite{cms_tdr}. 
  This speed is critical for coping with the 25~ns bunch spacing of the LHC's proton beams, so that the ECAL deposits produced by adjacent bunch crossings can be distinguished.
  Due to this rapid shower production and careful calibration of the electronics, the ECAL achieves a timing resolution of roughly 0.2~ns for particles with momenta on the order of tens of GeV \cite{ecaltiming}.

  Finally, lead tungstate is resistant to radiation damage, so that the ECAL can continuously operate in the high flux environment of LHC proton collisions.
  Unfortunately, it is not immune to radiation damage, and so the performance of the ECAL degrades over time.
  By the end of data taking in 2018, roughly 20\% of ECAL cells no longer consistently detected showers of photons and electrons.
  This leads to a background for the disappearing tracks search consisting of electrons that transform to photons inside the tracker, no longer leaving a track, but are not later detected as photons in the ECAL.
  Fortunately, 80\% of the ECAL is still performing well despites years of high radiation flux, so this background can be almost entirely rejected by mapping and vetoing the poorly performing cells, using events in which a Z boson decayed to a pair of electrons, exactly one of which is lost due to this effect, as described in Section~\ref{sec:distracks}.

  \subsection{Hadronic Calorimeter} \label{sec:hcal}

  Charged hadrons are too massive to shower significantly in the ECAL, and neutral hadrons are invisible even to the tracker.
  However, both can be made to shower by capitalizing on their powerful nuclear interactions, and the hadronic calorimeter (HCAL) accomplishes this, as depicted in Figure~\ref{fig:cmsreconstruction} for a neutral hadron in dotted green and a charged hadron in solid green.
  The performance of the HCAL is very important to analyses selecting events containing jets and missing energy, as HCAL measurement errors lead directly to errors in jet energies, which in turn cause errors in the inferred missing energy in the event.

  The essential plan of the CMS HCAL design is to induce hadron showers by putting a high density of atomic nuclei in their paths in the form of 5~cm brass plates, then to measure the products of these showers using plastic scintillators, and from this reconstruct the energies of the original hadrons.
  To ensure that as few hadrons as feasible escape detection, whether from the primary interaction or from secondary showers, there are multiple layers of this shower-inducing metal plate and scintillator combination.
  Nevertheless, some hadrons do manage to ``punch through'' the HCAL, especially if they have extremely high energy, and even successful measurements are only accurate to within roughly a factor of 2 \cite{HCALphase1}, unless that hadron has very high energy.
  On the whole, the CMS HCAL performance is the weakest of any detector system.
  However, the energy of a typical jet is not measured only with the HCAL, and errors made on different hadrons within a jet tend to cancel, so that CMS achieves a typical jet energy resolution of approximately 10\%, for the jets of most interest \cite{cms_tdr}.
  Still, jets are occasionally badly mismeasured, most often due to HCAL measurement errors, and it is important for analyses selecting events with large missing energy to filter out these mismeasurement events, see Section~\ref{sec:MT2bg}.

  Accuracy of energy measurements aside, the ability to detect neutral hadrons consistently in the HCAL is important to the disappearing tracks search discussed in Section~\ref{sec:distracks}.
  A charged hadron can decay to a neutral hadron inside the tracker, and thus allow known Standard Model physics to produce an apparent disappearing track.
  Unlike a true disappearing track, however, the neutral hadron is detectable in the HCAL, revealing what happened in the tracker and rejecting this Standard Model background.
  As with the ECAL, poorly performing regions of the HCAL can be vetoed to ensure this background is wholly rejected.

  \subsection{Muon System} \label{sec:muon}

  The muon system is the outermost detector of CMS, and the only one outside the solenoid.
  Muons, like charged hadrons, are too heavy to produce significant showers in the ECAL, and unlike hadrons, do not have nuclear interactions allowing them to be trapped in the HCAL.
  Instead, they penetrate through the entire detector, leaving a track in the tracker, largely disappearing inside the calorimeters, and then reappearing in the muon system.
  Unlike other particles, then, the energies of muons must be measured largely by analyzing the curvature of their tracks.
  As one of the design goals of the Compact Muon Solenoid experiment is ultra-precise measurements of muons, the muon system is large partly in order to provide a long look at the muon's track for momentum measurement purposes, and partly to provide a positive identification of a particle as a muon, rather than a hadron that managed to escape the HCAL, as only muons can penetrate through so many layers of detector material.
  As installing a second tracker would be far too expensive and excessive, the muon system instead uses only four widely spaced layers of detectors operating based on ionization of gas by passing muons, which while generally worse than the tracker system in terms of space and time resolution, are much more economical for covering such a large volume \cite{cms_tdr}.
  The design of CMS has proven successful. 
  Muons are by far the cleanest, most well-measured particles at CMS, with momentum resolution better than 1\% and high efficiency, as we have already seen for tracker muon tracks in Figure~\ref{trackefficiency}.

  While muons are the only charged Standard Model particle that can consistently penetrate to the muon system, the possibility exists that heavy long-lived charged particles beyond the Standard Model may be produced in LHC collisions and leave hits in the muon system.
  The disappearing tracks search in Section~\ref{sec:distracks} targets models that could potentially produce such a signature.
  However, that search considers only tracks that disappear inside the tracker, and in fact explicitly vetoes muon-like tracks, so it is not sensitive to this potential signature.
  Adding sensitivity to this powerful signature could be an interesting extension in the future.

  \subsection{Missing Transverse Energy} \label{sec:MET}

  Once muons are measured in the muon system, all Standard Model particles have been accounted for, except neutrinos.
  Unfortunately, the neutrino interaction length, even at LHC energies, is on the order of billions of meters at Earthly densities, so that the probability of a typical LHC neutrino experiencing even a single interaction anywhere inside the CMS detector is negligible \cite{neutrinos}.
  However, the presence of neutrinos can be inferred by measuring all other particles inside the event, and observing that the transverse momentum does not balance, indicating either the presence of at least one undetected particle, or a detector mismeasurement.
  At a hadron collider like the LHC, only the transverse momentum can be used for this procedure, because the exact center of momentum frame of the primary collision is unknown along the beam axis.
  The actual colliding particles are not the protons themselves, but rather subcomponents of the proton called partons.
  The partons are approximately at rest with respect to the detector in the transverse plane, so that their transverse momenta are known to sum nearly to zero, but have unkonwn momenta along the beam axis.
  Unbalanced momentum along this axis may indicate the presence of an invisible particle, but more often it indicates simply that the initial momentum of the collision along the beam axis was nonzero.
  The observable is not the missing energy, then, but the missing transverse energy, written as MET or \met.
  This observable is tentatively identified with the unobservable transverse momentum of a neutrino.

  Although the invisible momentum is only available in the transverse plane, it is still a very useful quantity.
  For instance, consider the leptonic decay of a W boson, $W^{\pm}\rightarrow\ell^{\pm}\nu$.
  The W boson has mass approximately 80~GeV with width approximately 2 GeV \cite{pdg}.
  Even allowing for detector resolution effects around 10\%, a lepton and neutrino system originating from an on-shell W decay can never have mass greater than approximately 100~GeV.
  It follows directly that transverse mass \Mt, the mass calculated using energy and momentum in the transverse plane, also cannot exceed 100~GeV, since $E_T < E$ and $\pt < p$.
  The analyses discussed in the next Section~\ref{sec:analysis} leverage this fact to determine whether a lepton or disappearing track may potentially have originated in a leptonic W decay.
  
  Of course, while the missing transverse energy is sometimes the undetected energy of a single neutrino or unknown invisible particle, it can also be a consequence of mismeasurement, or even potentially the vector sum of the transverse momenta of {\it multiple} undetected particles.
  In fact, even events with relatively large amounts of missing energy at CMS are most often produced by detector mismeasurement (see Figure~\ref{fig:mt2dist}, in which ``Multijet'' events in yellow have \met due to detector mismeasurement), even though such large errors are rare, because neutrinos are rarer still.
  Searches for invisible particles naturally wish to eliminate these events with fake \met using cleaning selections.
  One of the most powerful observables that can be used to reject events with fake \met is \mttwo \cite{mt2}, a generalization of \Mt.

    \subsubsection{\mttwo} \label{sec:MT2}

    Although the presence of invisible particles can be inferred via the observation of a nonzero \met vector, it is not trivial to distinguish events in which the \met corresponds to the transverse momentum of a single invisible particle, and events in which the \met is the vector sum of the momenta of multiple invisible particles.
    It can also be difficult to distinguish the presence of genuine invisible particles from cases of detector mismeasurement.
    While no conclusions about invisible content can ever be drawn with perfect certainty for any single event, the situation is not hopeless.
    The \mttwo observable is one tool used to make quantitative inferences concerning an event's invisible content.
    Specifically, \mttwo is designed to identify events consistent with the presence of two invisible particles in the final state, produced in symmetric decay chains of pair-produced heavy particles.
    This also tends to reject events in which the \met was produced by detector mismeasurement, as these events tend to have no symmetry whatsoever.

    The algorithm begins by dividing the visible portion of the event into two hemispheres.
    To do this, an event must have at least two visible objects, so in an event with only hadron jets, like the majority of the events at CMS, \mttwo can be calculated only for multijet events.
    The method used to assign each visible object to a hemisphere varies.
    One popular method, and the one used in \cite{MT2_2019}, begins by identifying the pair of objects with largest system mass, $M_{12}$,
    \begin{equation} \label{eqn:dijetmass}
      M_{12} = \sqrt{(E_1+E_2)^2-(\vec{p}_1+\vec{p}_2)^2},
    \end{equation}
    and assigning each as the seed of a separate hemisphere.
    In an event containing two identical pair-produced particles undergoing similar decay chains, the pair of objects with largest mass is unlikely to originate from the same particle, as the mass of the full system is strictly greater than the mass of either particle.

    Then, each object is associated to the seed of lesser Lund distance, $D_{L}$, which is defined for seed $i$ as \cite{lund1,lund2},
    \begin{equation} \label{eqn:lund}
      D_L = (E_{i}-p_{i}\cos\theta)\frac{E_{i}}{(E_{i}+E)^2}
    \end{equation}
    where $E_i$ is the seed's energy, $p_i$ is the seed's momentum, $\theta$ is the angle between the momenta of the seed and of the object under consideration, and $E$ is that object's energy.
    Considering the massless limit of $D_L$ provides some intuition,
    \begin{equation} \label{eqn:lund}
      D_L = \frac{1-\cos\theta}{(1+\frac{E}{E_h})^2}.
    \end{equation}
    The Lund distance is small if the hemisphere and object point in nearly the same direction so that $\cos\theta\sim1$, and if $E_i$ is small.
    Thus, selecting based on minimal Lund distance prefers to assign objects to the less energetic seed when possible to keep the hemispheres energetically balanced, so long as the object and the seed point in similar directions.
    Once all objects have been assigned to a seed, two new seeds are defined as the sum of all the four-momenta in each hemisphere, and the assignment procedure repeats using these seeds.
    This continues until no object changes hemisphere after an iteration.
    Ultimately, the algorithm assigns objects to the correct hemisphere with efficiency ranging from approximately 70--85\%, with higher efficiencies obtained in events with fewer objects and therefore reduced combinatorics \cite{lundeff}.

    The next step of the calculation of \mttwo takes these finalized hemispheres as inputs.
    Under the hypothesis that the observed missing energy is the vector sum of the unobserved momenta of two invisible particles, the algorithm considers every possible vector decomposition,
    \begin{equation}
      \ptvecmiss = \vec{v}_1+\vec{v}_2
    \end{equation}
    and calculates \Mt for hemisphere $i$ with respect to $\vec{v}_i$.
    The maximum of these two values of \Mt is taken as the {\it candidate} \mttwo for this decomposition.
    This choice is motivated by a desire to infer the true mass of the decaying pair-produced particle, again, under the hypothesis that there are two pair-produced particles undergoing symmetric partially invisible decays.
    For the correct \ptvecmiss decomposition and hemisphere assignments, the two calculated transverse masses are correct, and both are no larger than the true mass of the pair-produced particles. 
    The larger, of course, is nearer to that true mass.
    
    The only remaining step is to select which of the candidate values of \mttwo, equivalently which \ptvecmiss decomposition, is correct.
    The algorithm selects the smallest candidate \mttwo value found, the ``minimum maximum,'' so that the final \mttwo is
    \begin{equation} \label{eqn:minmax}
      \mttwo = \underset{\ptvecmiss = \vec{v}_1+\vec{v}_2}{\min}\left[\max\left(\Mt^1,\Mt^2\right)\right]
    \end{equation}
    where hemispheres 1 and 2 are assembled as described above.
    Since the correct missing energy decomposition is among those considered and manifestly cannot produce a value of \Mt greater than the true mass of the parent particle when hemisphere assignments are correct, selecting the ``minimum maximum'' guarantees that \mttwo can be no larger than the mass of the parent particle. 
    Just as \Mt cannot exceed the mass, \mttwo is unlikely to exceed the true \Mt.

    Of course, it is possible for \mttwo to be small even in genuine signal events for which it is designed to be large, and it is possible for especially pathological mismeasurement events to have large \mttwo despite \mttwo being a powerful rejector of these backgrounds (see Section~\ref{sec:MT2QCD}).
    No observable is so magical that it can accept 100\% of signal and reject 100\% of background.
    Still, \mttwo is one of the most powerful discriminants available for analyses targeting pair-produced particles decaying semi-invisibly, as can be seen for instance in Figure~\ref{fig:mt2dist}.
    Indeed, the selection of $\mttwo > 200$~GeV applied by the analyses discussed in Section~\ref{sec:analysis} is the single most important part of their baseline selection, dramatically reducing especially the detector mismeasurement background.

\section{CMS Event Reconstruction} \label{sec:reconstruction}

  \subsection{Challenges} \label{sec:challenges}

  Spray of thousands of particles, many in dense jets, from collisions distributed across a rather large beam crossing, millions of times per second.
  Pace is so high that travel of electrical impulses along the equipment is comparable to the collision frequency.

    \subsubsection{The Trigger System} \label{sec:trigger}

    High event rate needs to be suppressed due to computing limitations.
    High event rate is necessary to see rare things (how rare?).

    \subsubsection{Pileup} \label{sec:pileup}

    Obtaining a high enough event leads to many simultaneous collisions (not 1 proton collision at a time, but bunches crossing every 25 ns).
    Charged pileup contribution can be subtracted exactly using the tracker, but neutral pileup correction is heuristic.
    Effective area vs delta-beta.

    \begin{figure}[h!]
      \centering
      \includegraphics[width=0.65\textwidth]{figures/efficiencyVsPt.pdf}
      \caption[Pileup distribution in 2018.]{
        The distribution in 2018 of the number of simultaneous collisions per bunch crossing, so-called pileup, provided by the LHC and observed by CMS.
        The average bunch crossing produced 32 simultaneous collisions, with an inferred total inelastic collision cross section of 69.2~mb.
        Taken from \cite{lumipublic}.}
      \label{fig:pileup}
    \end{figure}  

  \subsection{Vertices} \label{sec:vertices}

  Use tracker to identify tracks and extrapolate them back to an origin point.
  These origins are vertices.

    \subsubsection{B-Tagging} \label{sec:btagging}

    Some tracks will not extrapolate back to a proton collision point but instead a point a few millimeters away: secondary vertices characteristic of b-tags.
    Describe other indicators used to identify b-jets and the efficiency.

  \subsection{Particle Flow} \label{sec:particleflow}

  Describe particle flow algorithm and advantage relative to other techniques.

  \subsection{Jet Clustering} \label{sec:jetclustering}

  Jets are made from PF candidates using anti-kt.
  How accurately?

\section{Simulation} \label{sec:simulation}

  The Standard Model and models of new physics predict what happens at the primary interaction, and this needs to be converted into a prediction for what happens in the detector.

  \section{Objectives} \label{sec:objectives}

  Used to study backgrounds and develop estimation techniques, and to design analyses to maximize sensitivity to expected signal signatures.

  \section{Limitations and Challenges} \label{sec:limitations}

  Ultra-detailed knowledge of the detector at the subatomic level at all locations is unachievable, and the detector's state evolves over time.
  QCD is irritating, and even electroweak physics is subject to theoretical uncertainties due partly to dependence on experimental inputs, and partly to calculating only to finite order.
  Can't run the simulation forever, and the computation is expensive.

  \section{The Simulation Pipeline} \label{sec:pipeline}

  Matrix elements (MadGraph), observed particles (pythia), how those particles interact with detector components (GEANT).
  Mention also fastsim vs fullsim (ie replacing GEANT with approximate smearing).
